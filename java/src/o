
import java.util.*;
import java.io.*;

/*
 * Class containing a mapping between two Keys.
 *
 * @author Murali Koppula.
 */

public class K2KMap<K,V> extends HashMap<K,V> {
    private HashMap reverseMap;

    public K2KMap() {
        super();
        this.reverseMap = new HashMap();
    }

    public Object get(Object k) {
        return super.getOrDefault(k, reverseMap.get(k));
    }

    public Object put(Object k1, Object k2) {
        Object prev = super.put(k1, k2);
        reverseMap.put(k2, k1);

        return prev;
    }

    public Object putIfAbsent(Object k1, Object k2) {
        Object prev = super.putIfAbsent(k1, k2);
        if (prev == null)
            reverseMap.putIfAbsent(k2, k1);

        return prev;
    }

    public void putAll(Map m) {
        super.putAll(m);

        // for (Map.Entry e : m.entrySet())
        //     reverseMap.put(e.getValue(), e.getKey());

        m.forEach((k,v) -> reverseMap.put(v,k));
    }

    public Set values() {
        return reverseMap.keySet();
    }

    public Object remove(Object k1) {
        Object prev = super.remove(k1);
        if (prev != null)
            reverseMap.remove(prev);

        return prev;
    }

    public void clear() {
        super.clear();
        reverseMap.clear();
    }
}

